<% breadcrumb :users %>
<main class="flex-grow-1 d-flex justify-content-center ">
  <div class="card p-5" style="width: 100%; max-width: 85%;">
    <div class=" d-flex justify-content-center">
      <h1>ユーザー一覧</h1>
    </div><br><br>
    <% @users.each do |user| %>
      <article class="card mb-2 w-75 mx-auto" data-testid="impression-item">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div class="text-muted small ">
              <%= link_to user.name, user_path(user) %>
              <% if current_user&.admin?%>
                <%= link_to "削除",
                            user_path(user),
                            data: { turbo_method: :delete, turbo_confirm: "本当に削除しますか？" },
                            class: "btn btn-outline-danger btn-sm" %> 
                <p><br>
                メールアドレス：
                <%= user.email %>
                </p>
                <p>
                利用開始日：
                <%= l user.created_at %>
                </p>
                <p>
                感想投稿数：
                <%= @impression_counts[user.id] || 0 %>
                </p>
              <% else %>                              
                <p><br>
                利用開始日：
                <%= l user.created_at, format: :short %>
                </p>
                <p>
                感想投稿数：
                <%= @impression_counts[user.id] || 0 %>
                </p>
              <% end %>
             

            </div>
          </div>
        </div>
      </article>
    <% end %>
  </div>
</main>